import { Metadata } from "next";
import Link from "next/link";
import { ArrowRight } from "lucide-react";
import { PageHero } from "@/components/about/page-hero";
import { SectionHeader } from "@/components/about/section-header";
import { StatsSection } from "@/components/about/stats-section";
import { ServiceFeatureCard } from "@/components/services/service-feature-card";
import { BenefitCard } from "@/components/services/benefit-card";
import { ProcessStep } from "@/components/services/process-step";
import { PricingCard } from "@/components/services/pricing-card";
import { CTASection } from "@/components/about/cta-section";

export const metadata: Metadata = {
  title: "Vulnerability Assessment Services | Security Scanning | IT Origin",
  description: "Comprehensive vulnerability assessment services to identify and prioritize security weaknesses across your infrastructure, applications, and cloud environments.",
  keywords: [
    "vulnerability assessment",
    "security scanning",
    "vulnerability management",
    "security assessment",
    "risk assessment",
    "infrastructure scanning",
    "compliance scanning",
    "CVE detection",
    "patch management",
    "security posture"
  ],
  openGraph: {
    title: "Vulnerability Assessment Services | Security Scanning | IT Origin",
    description: "Identify and prioritize security vulnerabilities across your entire infrastructure with comprehensive scanning and expert analysis.",
    type: "website",
    url: "https://itorigin.com/services/vulnerability-assessment",
  },
  alternates: {
    canonical: "https://itorigin.com/services/vulnerability-assessment"
  }
};

export default function VulnerabilityAssessmentPage() {
  const stats = [
    { label: "Vulnerabilities Identified", value: "50,000+", icon: "Search" as const },
    { label: "Systems Scanned", value: "10,000+", icon: "Server" as const },
    { label: "Avg. Detection Time", value: "<24hrs", icon: "Clock" as const },
    { label: "False Positive Rate", value: "<5%", icon: "CheckCircle" as const },
  ];

  const serviceFeatures = [
    {
      title: "Infrastructure Scanning",
      features: [
        "Network device vulnerability scanning",
        "Operating system security assessment",
        "Database security scanning",
        "Virtual infrastructure assessment",
        "IoT and OT device scanning",
        "Configuration compliance checking"
      ]
    },
    {
      title: "Application Assessment",
      features: [
        "Web application vulnerability scanning",
        "API security assessment",
        "Source code security analysis (SAST)",
        "Third-party component analysis (SCA)",
        "Container image scanning",
        "Dynamic application testing (DAST)"
      ]
    },
    {
      title: "Cloud Security Assessment",
      features: [
        "AWS security configuration review",
        "Azure security posture assessment",
        "GCP infrastructure scanning",
        "Cloud storage security analysis",
        "IAM policy assessment",
        "Serverless security review"
      ]
    }
  ];

  const benefits = [
    {
      icon: "Search" as const,
      title: "Complete Visibility",
      description: "Get a comprehensive view of vulnerabilities across your entire IT infrastructure and applications."
    },
    {
      icon: "BarChart" as const,
      title: "Risk-Based Prioritization",
      description: "Focus on what matters most with CVSS scoring, exploitability analysis, and business context."
    },
    {
      icon: "RefreshCcw" as const,
      title: "Continuous Monitoring",
      description: "Regular scanning schedules ensure new vulnerabilities are detected as they emerge."
    },
    {
      icon: "FileText" as const,
      title: "Detailed Reporting",
      description: "Comprehensive reports with technical details, remediation steps, and executive summaries."
    },
    {
      icon: "Zap" as const,
      title: "Fast Turnaround",
      description: "Receive initial findings within 24-48 hours, with full reports delivered promptly."
    },
    {
      icon: "CheckCircle2" as const,
      title: "Compliance Support",
      description: "Meet regulatory requirements for vulnerability management (PCI-DSS, HIPAA, SOC 2)."
    }
  ];

  const process = [
    {
      step: 1,
      title: "Asset Discovery",
      description: "Identify and inventory all assets in scope including servers, workstations, network devices, applications, and cloud resources. Create a comprehensive asset database for scanning."
    },
    {
      step: 2,
      title: "Vulnerability Scanning",
      description: "Execute comprehensive scans using industry-leading tools and custom scripts. Cover CVEs, misconfigurations, weak credentials, and compliance violations."
    },
    {
      step: 3,
      title: "Analysis & Validation",
      description: "Expert analysts review findings to eliminate false positives, validate vulnerabilities, and assess real-world exploitability. Correlate findings with threat intelligence."
    },
    {
      step: 4,
      title: "Risk Prioritization",
      description: "Prioritize vulnerabilities based on CVSS scores, exploitability, asset criticality, and business impact. Create a remediation roadmap focused on highest-risk issues."
    },
    {
      step: 5,
      title: "Reporting & Remediation Support",
      description: "Deliver detailed reports with findings, risk ratings, and remediation guidance. Provide ongoing support for vulnerability management and track remediation progress."
    }
  ];

  const pricingPlans = [
    {
      name: "One-Time Assessment",
      description: "Point-in-time vulnerability scan",
      price: "$1,999",
      features: [
        "Up to 50 IP addresses",
        "External + internal scanning",
        "Web application scanning",
        "Vulnerability report",
        "Risk prioritization",
        "Remediation guidance",
        "30-day support"
      ]
    },
    {
      name: "Quarterly Program",
      description: "Regular vulnerability assessments",
      price: "$4,999",
      features: [
        "Up to 100 IP addresses",
        "Quarterly scans (4 per year)",
        "Continuous asset discovery",
        "Trend analysis and reporting",
        "Compliance mapping",
        "Dedicated analyst",
        "Remediation tracking",
        "Priority support"
      ],
      highlighted: true
    },
    {
      name: "Continuous Monitoring",
      description: "24/7 vulnerability management",
      price: "Custom",
      features: [
        "Unlimited assets",
        "Daily/weekly scanning",
        "Real-time alerting",
        "Integration with SIEM/ticketing",
        "Custom scan policies",
        "Executive dashboards",
        "Remediation SLA tracking",
        "Dedicated security team"
      ]
    }
  ];

  return (
    <div className="min-h-screen">
      {/* Hero Section */}
      <PageHero
        badge={{ icon: "Search", text: "Vulnerability Assessment" }}
        title="Know Your"
        highlight="Security Weaknesses"
        description="Comprehensive vulnerability scanning and expert analysis to identify, prioritize, and remediate security weaknesses across your infrastructure, applications, and cloud environments."
      />

      {/* Hero CTA */}
      <section className="py-8 -mt-8">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex flex-wrap items-center justify-center gap-4">
            <Link
              href="#pricing"
              className="px-8 py-4 bg-primary text-primary-foreground rounded-lg font-semibold hover:bg-primary/90 transition-colors inline-flex items-center gap-2 group"
            >
              View Pricing
              <ArrowRight className="w-4 h-4 group-hover:translate-x-1 transition-transform" />
            </Link>
            <Link
              href="/contact"
              className="px-8 py-4 border border-border rounded-lg font-semibold hover:bg-accent transition-colors"
            >
              Get Free Scan
            </Link>
          </div>
        </div>
      </section>

      {/* Stats Section */}
      <StatsSection stats={stats} />

      {/* Service Features */}
      <section className="py-20 md:py-32">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <SectionHeader
            title="Comprehensive Scanning Coverage"
            description="We assess vulnerabilities across all layers of your technology stack."
          />

          <div className="grid md:grid-cols-3 gap-8">
            {serviceFeatures.map((feature, index) => (
              <ServiceFeatureCard key={index} {...feature} index={index} />
            ))}
          </div>
        </div>
      </section>

      {/* Benefits Section */}
      <section className="py-20 md:py-32 bg-accent/30">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <SectionHeader
            title="Why Choose Our Vulnerability Assessment"
            description="Expert-driven assessments that go beyond automated scanning."
          />

          <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            {benefits.map((benefit, index) => (
              <BenefitCard key={index} {...benefit} index={index} />
            ))}
          </div>
        </div>
      </section>

      {/* Difference Section */}
      <section className="py-20 md:py-32">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="max-w-4xl mx-auto">
            <div className="text-center mb-12">
              <h2 className="text-3xl md:text-5xl font-black mb-6">
                Vulnerability Assessment vs Penetration Testing
              </h2>
              <p className="text-lg text-muted-foreground">
                Understanding the difference helps you choose the right service for your needs.
              </p>
            </div>

            <div className="grid md:grid-cols-2 gap-8">
              <div className="p-8 rounded-2xl border border-primary bg-primary/5">
                <h3 className="text-xl font-black mb-4">Vulnerability Assessment</h3>
                <ul className="space-y-3 text-muted-foreground">
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Identifies known vulnerabilities across systems
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Broader coverage with automated scanning
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Lower cost, faster execution
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Ideal for regular security hygiene
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Compliance-focused reporting
                  </li>
                </ul>
              </div>

              <div className="p-8 rounded-2xl border border-border bg-card">
                <h3 className="text-xl font-black mb-4">Penetration Testing</h3>
                <ul className="space-y-3 text-muted-foreground">
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Actively exploits vulnerabilities
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Deeper analysis with manual testing
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Higher cost, more time-intensive
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Ideal for validating critical systems
                  </li>
                  <li className="flex items-start gap-2">
                    <span className="text-primary">•</span>
                    Real-world attack simulation
                  </li>
                </ul>
              </div>
            </div>

            <div className="text-center mt-8">
              <Link
                href="/services/penetration-testing"
                className="text-primary hover:underline font-semibold"
              >
                Learn more about our Penetration Testing services →
              </Link>
            </div>
          </div>
        </div>
      </section>

      {/* Process Section */}
      <section className="py-20 md:py-32 bg-accent/30">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <SectionHeader
            title="Our Assessment Process"
            description="A systematic approach to identifying and managing vulnerabilities."
          />

          <div className="max-w-4xl mx-auto space-y-8">
            {process.map((item, index) => (
              <ProcessStep key={index} {...item} index={index} />
            ))}
          </div>
        </div>
      </section>

      {/* Pricing Section */}
      <section id="pricing" className="py-20 md:py-32">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <SectionHeader
            title="Flexible Pricing Options"
            description="Choose the assessment program that fits your security requirements."
          />

          <div className="grid md:grid-cols-3 gap-8">
            {pricingPlans.map((plan, index) => (
              <PricingCard key={index} {...plan} index={index} />
            ))}
          </div>

          <div className="text-center mt-12">
            <p className="text-muted-foreground mb-4">
              All assessments include expert analysis and remediation guidance.
            </p>
            <Link
              href="/contact"
              className="text-primary hover:underline font-semibold"
            >
              Need custom coverage? Contact us for a tailored solution
            </Link>
          </div>
        </div>
      </section>

      {/* CTA Section */}
      <CTASection
        title="Start Your Vulnerability Assessment Today"
        description="Get complete visibility into your security weaknesses and a clear path to remediation."
        buttons={[
          { text: "Request Assessment", href: "/contact" },
          { text: "View Pen Testing", href: "/services/penetration-testing", variant: "secondary" }
        ]}
      />
    </div>
  );
}
